import sqlite3
import os

VERITABANI_ADI = "staj_erp.db"

def veritabani_olustur():
    if os.path.exists(VERITABANI_ADI):
        os.remove(VERITABANI_ADI)
        print(f"Eski '{VERITABANI_ADI}' dosyası silindi. Yenisi oluşturuluyor...")
    conn = sqlite3.connect(VERITABANI_ADI); cursor = conn.cursor()
    print(f"'{VERITABANI_ADI}' veritabanı başarıyla oluşturuldu.")
    cursor.execute('CREATE TABLE Urun_Kartlari (UrunKodu TEXT PRIMARY KEY, UrunAdi TEXT NOT NULL, UrunTuru TEXT, MaliyetFiyati REAL NOT NULL, BirimFiyati REAL NOT NULL, MevcutStok INTEGER NOT NULL, KritikStok INTEGER NOT NULL )'); print("Tablo 'Urun_Kartlari' oluşturuldu.")
    cursor.execute('CREATE TABLE Cari_Kartlar (MusteriKodu TEXT PRIMARY KEY, FirmaUnvani TEXT NOT NULL, Sehir TEXT, Sektor TEXT, AktifMi INTEGER DEFAULT 1)'); print("Tablo 'Cari_Kartlar' (AktifMi ile) oluşturuldu.") # AktifMi EKLENDİ
    cursor.execute('CREATE TABLE Satis_Hareketleri (SatisKodu TEXT PRIMARY KEY, Tarih TEXT NOT NULL, MusteriKodu TEXT NOT NULL, UrunKodu TEXT NOT NULL, SatisMiktari REAL NOT NULL, SatisKanali TEXT, OdemeDurumu TEXT, Tutar REAL NOT NULL, FOREIGN KEY (MusteriKodu) REFERENCES Cari_Kartlar (MusteriKodu), FOREIGN KEY (UrunKodu) REFERENCES Urun_Kartlari (UrunKodu) )'); print("Tablo 'Satis_Hareketleri' oluşturuldu.")
    print("Tablolar başarıyla oluşturuldu. Şimdi veriler ekleniyor...")
    urunler=[('MBL-001','Mobilya Menteşesi Tip-X','Mobilya Aksesuar',30,50,10000,500),('MBL-002','Çekmece Rayı 40cm','Mobilya Aksesuar',55,90,5000,500),('MBL-003','PVC Kenar Bandı 22mm (1 Rulo)','Mobilya Sarf',4,7,50000,5000),('MBL-004','Metal Kulp Model-A','Mobilya Aksesuar',22,40,8000,1000),('CELIK-001','10mm Çelik Flanş','Metal İşleme',85,150,8000,1000),('BORU-001','2 inç Sanayi Borusu (Metre)','Metal İşleme',180,280,3000,300),('CIVATA-M12','M12x50 Endüstriyel Cıvata','Bağlantı Elemanı',3.5,6,100000,10000),('RULMAN-608','608 Tip Rulman','Makine Parçası',18,30,15000,2000),('KBL-001','PVC Kablo Granülü (KG)','Polimer',60,100,15000,2000),('KBL-002','Alüminyum İletken Tel 16mm (Metre)','Enerji Malzemesi',110,180,6000,1000),('KBL-003','Isı Büzüşmeli Makaron 10mm (Metre)','İzolasyon',8,15,25000,3000),('YAZILIM-001','Logo Tiger 3 Lisans','Yazılım',50000,120000,999,10),('CAM-001','Endüstriyel Isıcam Panel','İnşaat Malzemesi',350,600,2000,100),('E-CAT6','Cat6 Ethernet Kablosu (Metre)','Bilişim',9,25,40000,5000),('BAT-LITYUM','Lityum-İyon Pil Paketi 12V','Enerji Depolama',450,750,1500,150),('KARTON-KOLI','Koli (50x50x50cm)','Ambalaj',12,20,30000,2000)]; cursor.executemany("INSERT INTO Urun_Kartlari VALUES (?,?,?,?,?,?,?)", urunler); print(f"{len(urunler)} adet ürün başarıyla eklendi.")
    musteriler=[('M-HAS01','Hasçelik Sanayi ve Tic. A.Ş.','Kayseri','Metal',1),('M-IST01','İstikbal Mobilya A.Ş.','Kayseri','Mobilya',1),('M-BEL01','Bellona Mobilya A.Ş.','Kayseri','Mobilya',1),('M-HES01','HES Kablo','Kayseri','Enerji',1),('M-ERB01','Erbosan A.Ş.','Kayseri','Metal',1),('M-YATAS','Yataş A.Ş.','Kayseri','Mobilya',1),('M-KUMTEL','Kumtel A.Ş.','Kayseri','Dayanıklı Tüketim',1),('M-ASPILSAN','Aspilsan Enerji A.Ş.','Kayseri','Enerji',1),('A-MIKRODIS','Mikrodis Yazılım Ltd. Şti.','Ankara','Bilişim',1),('A-GURIS','Güriş Makina A.Ş.','Ankara','İmalat',1)]; cursor.executemany("INSERT INTO Cari_Kartlar VALUES (?,?,?,?,?)", musteriler); print(f"{len(musteriler)} adet müşteri başarıyla eklendi.") # 5. değer '1' olarak eklendi
    satislar=[('SAT-1001','14.07.2025','M-IST01','MBL-001',950,'Saha','Ödendi',47500),('SAT-1002','15.07.2025','M-HAS01','CELIK-001',512,'Telefon','Vadesi Geçti',76800),('SAT-1003','16.07.2025','M-HES01','KBL-001',2250,'Saha','Bekleniyor',225000),('SAT-1004','17.07.2025','M-BEL01','MBL-002',775,'Web','Ödendi',69750),('SAT-1005','18.07.2025','M-ERB01','BORU-001',140,'Telefon','Bekleniyor',39200),('SAT-1006','21.07.2025','M-YATAS','MBL-003',5040,'Saha','Ödendi',35280),('SAT-1007','22.07.2025','M-KUMTEL','KBL-002',310,'Web','Bekleniyor',55800),('SAT-1008','23.07.2025','M-ASPILSAN','BAT-LITYUM',78,'Telefon','Ödendi',58500),('SAT-1009','24.07.2025','A-MIKRODIS','YAZILIM-001',1,'Saha','Ödendi',120000),('SAT-1010','25.07.2025','A-GURIS','RULMAN-608',2000,'Telefon','Bekleniyor',60000),('SAT-1011','28.07.2025','M-IST01','MBL-004',1250,'Web','Ödendi',50000),('SAT-1012','29.07.2025','M-HAS01','BORU-001',88,'Saha','Ödendi',24640),('SAT-1013','01.08.2025','A-GURIS','CIVATA-M12',15000,'Saha','Bekleniyor',90000),('SAT-1014','04.08.2025','M-BEL01','KARTON-KOLI',3000,'Telefon','Ödendi',60000),('SAT-1015','07.08.2025','M-HES01','KBL-003',5500,'Web','Bekleniyor',82500),('SAT-1016','11.08.2025','M-ERB01','CELIK-001',320,'Saha','Ödendi',48000),('SAT-1017','14.08.2025','M-IST01','MBL-002',410,'Web','Ödendi',36900),('SAT-1018','18.08.2025','A-MIKRODIS','E-CAT6',2000,'Telefon','Bekleniyor',50000),('SAT-1019','21.08.2025','M-HAS01','CIVATA-M12',5000,'Saha','Vadesi Geçti',30000),('SAT-1020','22.08.2025','M-ASPILSAN','BAT-LITYUM',50,'Telefon','Ödendi',37500)]; cursor.executemany("INSERT INTO Satis_Hareketleri VALUES (?,?,?,?,?,?,?,?)", satislar); print(f"{len(satislar)} adet satış kaydı başarıyla eklendi.")
    conn.commit(); conn.close()
    print("\n--- KURULUM TAMAMLANDI (AktifMi Sütunu Eklendi, DB Sıfırlandı) ---")
if __name__ == "__main__": veritabani_olustur()